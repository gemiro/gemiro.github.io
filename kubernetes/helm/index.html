<!DOCTYPE html>
<html lang="ko" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.54.0" />
    <meta name="description" content="민재아빠의 스터디룸">
<meta name="author" content="민재아빠">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Helm :: 민재아빠의 스터디룸</title>

    
    <link href="/css/nucleus.css?1554629829" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1554629829" rel="stylesheet">
    <link href="/css/hybrid.css?1554629829" rel="stylesheet">
    <link href="/css/featherlight.min.css?1554629829" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1554629829" rel="stylesheet">
    <link href="/css/auto-complete.css?1554629829" rel="stylesheet">
    <link href="/css/theme.css?1554629829" rel="stylesheet">
    <link href="/css/hugo-theme.css?1554629829" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1554629829" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1554629829"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8143479232104530",
        enable_page_level_ads: true
    });
</script>
  </head>
  <body class="" data-url="/kubernetes/helm/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="grav-logo" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	width="100%" height="100%"  viewBox="0 0 285.1 69.9" xml:space="preserve">
<g>
	<path d="M35,0c9.6,0,17.9,3.4,24.7,10.3c6.8,6.8,10.3,15,10.3,24.7c0,9.7-3.4,17.9-10.3,24.7c-6.8,6.8-15,10.3-24.7,10.3
		c-9.7,0-17.9-3.4-24.7-10.3C3.4,52.8,0,44.6,0,34.9c0-9.6,3.4-17.9,10.3-24.7C17.1,3.4,25.3,0,35,0z M22.3,63.7
		c0.3-7.4,0.3-14.7,0-22.1c-2.1-0.4-4-0.4-5.9,0c-0.2,0.8-0.2,2.5-0.1,4.9c0.1,2.3,0,3.9-0.3,4.8c-1.7-0.6-2.7-2.1-3.1-4.6
		c-0.1-0.7-0.1-3.3-0.1-8c0-14.5-0.1-23-0.3-25.6c-3.6,4.1-5.6,7-5.9,8.5v10.9c0,4.5,0.1,8.1,0.2,10.9c0,0.4,0,1.3-0.1,2.8
		c-0.1,1.2,0,2.1,0.1,2.6c0.1,0.6,1.1,2.1,2.8,4.7C13.2,58.7,17.5,62.2,22.3,63.7z M44.6,65.4c0.3-5,0.2-12.9-0.1-23.6
		c-2.1-0.3-4.1-0.3-5.9,0c-0.2,2-0.2,5.1-0.1,9.5c0.1,4.3,0,7.5-0.1,9.5c-2.9,0.4-5,0.3-6.2-0.1c-0.2-5.6-0.2-15.2-0.1-28.7
		c0.1-12.4,0-21.8-0.3-28.3c-2.4,0.1-4.3,0.6-5.7,1.3c-0.1,7.7-0.2,17.7-0.1,30.1c0,16.5,0,26.6,0,30.3c2.3,1.1,5.4,1.7,9.4,1.7
		C38.9,66.9,42.1,66.4,44.6,65.4z M48.1,64.1c9.7-4.6,15.7-12,18-22.2c-1.8-0.2-3.8-0.3-6.1-0.3c-1.6,3.9-2.6,6.3-3.2,7.2
		c-1.1,1.7-2,2.5-2.7,2.5C54,46,54,39.1,54,30.5c0-11.5,0-18.4,0-20.9c-1.4-1.4-3.3-2.5-5.7-3.4C48.1,6.3,48,6.4,48,6.7
		c0,3.5,0,13.1,0,28.8C47.9,47.2,48,56.8,48.1,64.1z"/>
</g>
<g>
	<path d="M116.6,51.3h-29c-0.5,0-0.9-0.1-1.3-0.2c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-1c-0.2-0.4-0.2-0.8-0.2-1.3V16.3h6.3
		V45h25.8V51.3z"/>
	<path d="M154.8,51.3h-22.9c-0.9,0-1.8-0.2-2.9-0.5c-1-0.3-2-0.8-2.9-1.5c-0.9-0.7-1.6-1.6-2.2-2.8c-0.6-1.1-0.9-2.5-0.9-4.2V19.5
		c0-0.4,0.1-0.9,0.2-1.2c0.2-0.4,0.4-0.7,0.7-1c0.3-0.3,0.6-0.5,1-0.7c0.4-0.2,0.8-0.2,1.3-0.2h28.6v6.3h-25.4v19.8
		c0,0.8,0.2,1.5,0.7,1.9s1.1,0.7,1.9,0.7h22.9V51.3z M151.9,37h-20v-6.4h20V37z"/>
	<path d="M197.3,51.3H191v-8.6h-22.3v8.6h-6.3V33.8c0-2.6,0.4-4.9,1.3-7.1s2.1-4,3.7-5.5c1.6-1.5,3.4-2.8,5.5-3.6
		c2.1-0.9,4.5-1.3,7-1.3h14.3c0.4,0,0.9,0.1,1.2,0.2c0.4,0.2,0.7,0.4,1,0.7s0.5,0.6,0.7,1c0.2,0.4,0.2,0.8,0.2,1.2V51.3z
		 M168.7,36.4H191V22.6h-11.2c-0.2,0-0.6,0-1.2,0.1c-0.6,0.1-1.4,0.2-2.2,0.4c-0.8,0.2-1.7,0.6-2.6,1c-0.9,0.5-1.8,1.1-2.5,2
		c-0.8,0.8-1.4,1.9-1.9,3.1c-0.5,1.2-0.7,2.8-0.7,4.5V36.4z"/>
	<path d="M241.7,28.1c0,1.4-0.2,2.7-0.5,3.9c-0.4,1.1-0.8,2.1-1.5,3c-0.6,0.9-1.3,1.6-2.1,2.2c-0.8,0.6-1.6,1.1-2.5,1.5
		c-0.9,0.4-1.8,0.7-2.6,0.9c-0.9,0.2-1.7,0.3-2.5,0.3l13.3,11.5h-9.8l-13.2-11.5h-4.6v-6.3H230c0.8-0.1,1.5-0.2,2.2-0.5
		c0.7-0.3,1.2-0.6,1.7-1.1c0.5-0.5,0.9-1,1.1-1.6c0.3-0.6,0.4-1.4,0.4-2.2v-4c0-0.4,0-0.6-0.1-0.8c-0.1-0.2-0.2-0.3-0.3-0.4
		c-0.1-0.1-0.3-0.1-0.4-0.2c-0.2,0-0.3,0-0.4,0h-20.9v28.7h-6.3V19.5c0-0.4,0.1-0.9,0.2-1.2c0.2-0.4,0.4-0.7,0.7-1
		c0.3-0.3,0.6-0.5,1-0.7c0.4-0.2,0.8-0.2,1.3-0.2H234c1.4,0,2.6,0.3,3.6,0.8s1.8,1.2,2.4,1.9c0.6,0.8,1,1.6,1.3,2.5
		c0.3,0.9,0.4,1.7,0.4,2.5V28.1z"/>
	<path d="M285.1,48.6c0,0.5-0.1,0.9-0.3,1.3c-0.2,0.4-0.4,0.7-0.7,1c-0.3,0.3-0.6,0.5-1,0.7c-0.4,0.2-0.8,0.2-1.2,0.2
		c-0.4,0-0.8-0.1-1.2-0.2c-0.4-0.1-0.8-0.4-1.1-0.7l-23.2-24.2v24.7h-6.3V19c0-0.7,0.2-1.2,0.5-1.8c0.4-0.5,0.8-0.9,1.4-1.2
		c0.6-0.2,1.2-0.3,1.9-0.2s1.2,0.4,1.6,0.9l23.2,24.2V16.3h6.3V48.6z"/>
</g>
</svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1554629829"></script>
<script type="text/javascript" src="/js/auto-complete.js?1554629829"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1554629829"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/kubernetes/" title="Kubernetes" class="dd-item 
        parent
        
        
        ">
      <a href="/kubernetes/">
          <b>> </b>Kubernetes
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/installation/" title="쿠버네티스 설치하기" class="dd-item 
        
        
        
        ">
      <a href="/kubernetes/installation/">
          Installation
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/kubernetes/helm/" title="Helm" class="dd-item 
        parent
        active
        
        ">
      <a href="/kubernetes/helm/">
          Helm
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spring-boot/" title="Spring Boot" class="dd-item 
        
        
        
        ">
      <a href="/spring-boot/">
          <b>> </b>Spring Boot
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/matcornic/hugo-theme-learn"><i class='fab fa-fw fa-github'></i> Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://learn.netlify.com/en/"><i class='fas fa-fw fa-bookmark'></i> Learn Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="/credits"><i class='fas fa-fw fa-bullhorn'></i> Credits</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/matcornic/hugo-theme-learn/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download matcornic/hugo-theme-learn on GitHub">Download</a>

    
    <a class="github-button" href="https://github.com/matcornic/hugo-theme-learn" data-icon="octicon-star" data-show-count="true" aria-label="Star matcornic/hugo-theme-learn on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/matcornic/hugo-theme-learn/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork matcornic/hugo-theme-learn on GitHub">Fork</a>

    <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/gemiro/blog/edit/master/content/kubernetes/helm/_index.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Study Room of Min-Jae Papa</a> > <a href='/kubernetes/'>Kubernetes</a> > Helm
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#소개">소개</a></li>
<li><a href="#사전-준비">사전 준비</a></li>
<li><a href="#설치">설치</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Helm</h1>
          

        




<h3 id="소개">소개</h3>

<p>Kubernetes는 컨테이너 이미지를 배포하고 운영함에 있어 필요한 다양한 오케스트레이션 기능등을 지원하는 플랫폼이다.
Kubernetes는 오케스트레이션 기능을 위해 YAML(또는 json) 파일을 사용하여 기능을 정의하고 관리한다.
하나의 컨테이너 이미지를 배포하기 위해서는 Kubernetes에서 제공하는 다양한 기능들을 이해하고 이를 YAML 파일을 사용하여 작성할 수 있어야하는데,
실제로 이미 잘 알려진 Mysql, MongoDB, Redis 등의 컨테이너 이미지를 사용하여
직접 YAML 파일을 작성하여 배포해 보면 이 일이 그렇게 말처럼 쉽지 않다는 것을 알 수 있다.
때문에 Kubernetes에서도 centos의 yum이나 ubuntu의 apt-get를 사용하면 쉽게 서비스를 설치하고 관리할 수 있는 것처럼 helm이라는 패키지 매니저가 나오게 되었다.</p>

<p>helm은 Kubernetes를 위한 패키지 매니저로써 helm 명령어를 통해 쉽게 어플리케이션을 배포하고 업데이트 삭제 등을 할 수 있다.
helm은 어플리케이션을 배포하기 위해 chart repository를 사용하는데 이 repository에는 사용자 설정에 따라 kubernetes yaml을 동적으로 생성할 수 있는 chart 들이 저장되어 있다.
chart는 직접 생성도 가능하지만 이미 Public으로 구축된 chart repository를 보면 대부분 필요한 어플리케이션등이 이미 마련되어 있다는 것을 알 수 있다.</p>

<h3 id="사전-준비">사전 준비</h3>

<ul>
<li>Kubernetes를 설치하고 master로 접속</li>
<li>kube config를 설정하여 kubectl 명령어를 사용할 수 있는 상태</li>
<li>Master node 에서 인터넷 접속이 가능한지 확인</li>
</ul>

<h3 id="설치">설치</h3>

<p><a href="https://helm.sh/docs/using_helm/#from-script">helm</a> 사이트에서 다양한 설치 방법을 제공하고 있는데 가장 쉽게 설치할 수 있는 방법은 스크립트를 다운받아 설치하는 것을 추천한다.</p>

<p>아래 과정을 통해 스크립트를 다운받고 실행한다. 그러면 helm을 설치할 수 있는 환경이 구성된다.</p>

<pre><code class="language-bash">curl https://raw.githubusercontent.com/helm/helm/master/scripts/get &gt; get_helm.sh
chmod 700 get_helm.sh
./get_helm.sh
</code></pre>

<p>환경이 구성되었으면 다음은 tiller를 설치해야 한다. tiller는 helm 서버의 일부분으로 kubernetes cluster에 pod로 올라간다.
tiller는 기본적으로 kube-system namespace에 배포되고 tiller를 통해 배포되는 어플리케이션들은 실제로 다른 namespace에 배포되기 때문에
tiller에 적절한 cluster role이 설정되어야 한다. 아래 shell 명령어는 cluster-admin cluster role을 생성하고 이를 tiller에 binding 한 후
<code>helm init</code>을 통해 tiller를 배포하게 된다.</p>

<pre><code class="language-bash">kubectl create serviceaccount --namespace kube-system tiller
kubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller
helm init
kubectl patch deploy --namespace kube-system tiller-deploy -p '{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;serviceAccount&quot;:&quot;tiller&quot;}}}}'
</code></pre>

<p>배포가 완료 되었으면 아래 명령어를 통해 helm이 잘 동작하는지 확인한다.</p>

<pre><code class="language-bash"># helm repository 확인 : 기본적으로 stable repository만 검색이 된다.
helm search
# NAME                                            CHART VERSION   APP VERSION                     DESCRIPTION
# incubator/artifactory                           5.2.1           5.2.0                           DEPRECATED Universal Repository Manager supporting all ma...
# incubator/aws-alb-ingress-controller            0.1.4           v1.0.1                          A Helm chart for AWS ALB Ingress Controller
# incubator/azuremonitor-containers               0.5.0           2.0.0-3                         Helm chart for deploying Azure Monitor container monitori...
# incubator/burrow                                0.3.3           0.17.1                          Burrow is a permissionable smart contract machine
# incubator/cassandra                             0.10.4          3.11.3                          Apache Cassandra is a free and open-source distributed da...
# ...


helm install --name my-release stable/mysql
# NAME:   my-release
# LAST DEPLOYED: Sun Apr  7 16:51:10 2019
# NAMESPACE: default
# STATUS: DEPLOYED
# 
# RESOURCES:
# ==&gt; v1/ConfigMap
# NAME                   DATA  AGE
# my-release-mysql-test  1     1s
# 
# ==&gt; v1/PersistentVolumeClaim
# NAME              STATUS   VOLUME  CAPACITY  ACCESS MODES  STORAGECLASS  AGE
# my-release-mysql  Pending  1s
# 
# ==&gt; v1/Pod(related)
# NAME                               READY  STATUS   RESTARTS  AGE
# my-release-mysql-796c4bdb6c-z7mqc  0/1    Pending  0         1s
# 
# ==&gt; v1/Secret
# NAME              TYPE    DATA  AGE
# my-release-mysql  Opaque  2     1s
# 
# ==&gt; v1/Service
# NAME              TYPE       CLUSTER-IP      EXTERNAL-IP  PORT(S)   AGE
# my-release-mysql  ClusterIP  10.107.170.208  &lt;none&gt;       3306/TCP  1s
# 
# ==&gt; v1beta1/Deployment
# NAME              READY  UP-TO-DATE  AVAILABLE  AGE
# my-release-mysql  0/1    1           0          1s
# 
# 
# NOTES:
# MySQL can be accessed via port 3306 on the following DNS name from within your cluster:
# my-release-mysql.default.svc.cluster.local
# 
# To get your root password run:
# 
#     MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default my-release-mysql -o jsonpath=&quot;{.data.mysql-root-password}&quot; | base64 --decode; echo)
# 
# To connect to your database:
# 
# 1. Run an Ubuntu pod that you can use as a client:
# 
#     kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il
# 
# 2. Install the mysql client:
# 
#     $ apt-get update &amp;&amp; apt-get install mysql-client -y
# 
# 3. Connect using the mysql cli, then provide your password:
#     $ mysql -h my-release-mysql -p
# 
# To connect to your database directly from outside the K8s cluster:
#     MYSQL_HOST=127.0.0.1
#     MYSQL_PORT=3306
# 
#     # Execute the following command to route the connection:
#     kubectl port-forward svc/my-release-mysql 3306
# 
#     mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD}

# 위와 같은 결과가 출력되면 helm이 잘 작동한다는 것이다.

# 아래 명령어는 배포된 mysql를 삭제하는 명령어이며 --purge 옵션은 배포된 my-release에 대한 name 히스토리를 삭제한다는 옵션이다. 
# 만약 --purge 옵션을 주지 않고 삭제한 경우 다음 배포할 때 my-release 이름으로 배포하면 에러가 난다.   
helm delete my-release --purge
</code></pre>


<footer class=" footline" >
	
</footer>

        
        </div> 
        
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gemiro" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1554629829"></script>
    <script src="/js/perfect-scrollbar.min.js?1554629829"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1554629829"></script>
    <script src="/js/jquery.sticky.js?1554629829"></script>
    <script src="/js/featherlight.min.js?1554629829"></script>
    <script src="/js/html5shiv-printshiv.min.js?1554629829"></script>
    <script src="/js/highlight.pack.js?1554629829"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1554629829"></script>
    <script src="/js/learn.js?1554629829"></script>
    <script src="/js/hugo-learn.js?1554629829"></script>

    <link href="/mermaid/mermaid.css?1554629829" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1554629829"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-111727138-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
